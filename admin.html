<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>

<link rel="stylesheet" href="./style.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script src="./firebase.js"></script>
</head>

<body>

<div class="dashboard">

  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>Admin</h2>
    <a href="#" class="active">Dashboard</a>
    <a href="#">Teachers</a>
    <a href="#">Reports</a>
    <button onclick="logout()" class="logout-btn">Logout</button>
  </aside>

  <!-- Main -->
  <main class="content">
    <h1>Welcome, Admin ðŸ‘‹</h1>
    <p>All registered teachers & classes</p>

    <div id="teachers" class="cards"></div>
  </main>

</div>

<script>
  // Protect page
  firebase.auth().onAuthStateChanged(user => {
    if (!user) location.href = "login.html";
  });

  const teachersDiv = document.getElementById("teachers");

  firebase.database().ref("teachers").on("value", snapshot => {
    teachersDiv.innerHTML = "";

    if (!snapshot.exists()) {
      teachersDiv.innerHTML = "<p>No teachers found</p>";
      return;
    }

    snapshot.forEach(teacherSnap => {
      const teacher = teacherSnap.val();
      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <h3>${teacher.name || "No Name"}</h3>
        <p>${teacher.email || "No Email"}</p>
        <p><b>Classes:</b> ${
          teacher.classes ? Object.keys(teacher.classes).join(", ") : "None"
        }</p>
      `;

      teachersDiv.appendChild(card);
    });
  });

  function logout() {
    firebase.auth().signOut().then(() => {
      location.href = "login.html";
    });
  }
</script>

</body>
</html>
