<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <link rel="stylesheet" href="style.css">

  <!-- Firebase CDN (MUST BE BEFORE YOUR JS) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>

<div class="login-box">
  <h2>Login</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button class="btn primary" onclick="login()">Login</button>
</div>

<script>
  // ✅ Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyB3ytMC77uaEwdqmXgr1t-PN0z3qV_Dxi8",
    authDomain: "smart-attendance-system-17e89.firebaseapp.com",
    databaseURL: "https://smart-attendance-system-17e89-default-rtdb.firebaseio.com",
    projectId: "smart-attendance-system-17e89",
    storageBucket: "smart-attendance-system-17e89.appspot.com",
    messagingSenderId: "168700970246",
    appId: "1:168700970246:web:392156387db81e92544a87"
  };

  firebase.initializeApp(firebaseConfig);

  // ✅ LOGIN FUNCTION (GLOBAL)
  function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    firebase.auth().signInWithEmailAndPassword(email, password)
      .then((cred) => {
        const uid = cred.user.uid;

        firebase.database().ref("users/" + uid).once("value")
          .then(snapshot => {
            if (!snapshot.exists()) {
              alert("Role not found in database");
              return;
            }

            const role = snapshot.val().role;

            if (role === "admin") window.location.href = "admin.html";
            else if (role === "teacher") window.location.href = "teacher.html";
            else if (role === "student") window.location.href = "student.html";
          });
      })
      .catch(err => alert(err.message));
  }
</script>

</body>
</html>
